---
layout:     post
title:      React 组件渲染
subtitle:   一问读懂 React 组件渲染
date:       2023-11-27
author:     sanlinblackball
header-img: img/Ju-ITc1Cc0w.jpg
catalog: true
tags:
- React
- Diff
- Fiber
---

## 前言
在React开发中不可避免 我们总要用到`setState` 或者 `useState`相关以此来更新界面，但是在渲染中究竟发生了什么呢？让我们带着疑问一步一步看看。
## 前置
在React 中我们使用的是 `声明式渲染` ，我们 只需要声明与描述 就可以渲染出我们所需要的东西。声明式渲染是现代前端框架的比较普遍的设计思路。
而我们在编写类似 `HTML` 的语法编写组件时，通过`Babel`转成了浏览器能够识别的样子，在通过“加工”呈现在了用户面前。 `Babel` 把JSX编译成 `React.createElement` 的样子。
让我们看看一个例子。
```	js

const element = <h1 title="Word">Hello</h1>;
```
转换以后得代码变成了
```	js
const element = {
  type: "h1", //标签类型
  props: { 
    title: "Word", //dom属性
    children: "Hello", //嵌套内容
  },
}
```
显而易见，我们从转变后可以看出他转变成了一个数据类型，这个数据类型包含渲染界面的一些数据。

在查看源码的时候我们可以看出 ReactElement 数据类型
```	js
var element = {
    // This tag allows us to uniquely identify this as a React Element 
    $$typeof: REACT_ELEMENT_TYPE,
    // Built-in properties that belong on the element
    type: type,
    key: key,
    ref: ref,
    _store:_store,
    props: props,
    source: source
    // Record the component responsible for creating this element.
    _owner: owner
    _self: _self
  };
```
#### 拓展
有的时候我们也会疑惑，如果简单一些讲解 是怎么生成UI界面的呢。我们简单的描描述一下。

``` js
import React from 'react';
import ReactDOM from 'react-dom';

const element = <h1 title="Word">Hello</h1>;
const container = document.getElementById("root");
ReactDOM.render(element, container);
```
转变成了
``` js
const element = {
  type: "h1", //标签类型
  props: { 
    title: "Word", //dom属性
    children: "Hello", //嵌套内容
  },
}

const container = document.getElementById("root")

const node = document.createElement(element.type)
node["title"] = element.props.title

const text = document.createTextNode("")
text["nodeValue"] = element.props.children

node.appendChild(text)
container.appendChild(node)
```
通过 `node.appendChild`实现了界面的渲染展示。当然这中间还有一些渲染时机和优化等等 这里并未体现。